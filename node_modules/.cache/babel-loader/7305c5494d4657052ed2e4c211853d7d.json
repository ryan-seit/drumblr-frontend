{"ast":null,"code":"var _jsxFileName = \"/Users/ryan/Documents/GitHub/drumblr_frontend/src/App.js\";\nimport React from 'react';\nimport MIDISounds from 'midi-sounds-react';\nimport SampleContainer from './SampleContainer';\nimport HeaderContainer from './HeaderContainer';\nimport NavBar from './NavBar';\nimport './css/App.css';\nconst URL = 'http://localhost:3000';\nexport default class App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      // just chose a default bpm to set state with\n      bpm: 120,\n      // name for saved beats\n      name: 'test',\n      // I just hardcoded in some basic drums to start\n      drumObjs: [{\n        midiID: 3,\n        name: 'Bass Drum',\n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]\n      }, {\n        midiID: 22,\n        name: 'Hand Clap',\n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]\n      }, {\n        midiID: 26,\n        name: 'Snare',\n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]\n      }, {\n        midiID: 35,\n        name: 'Closed Hi-hat',\n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]\n      }]\n    };\n\n    this.playSequence = () => {\n      // gets array of notes with value of true\n      let notesToPlay = [];\n      let drums = [...this.state.drumObjs];\n\n      for (let i = 0; i < drums.length; i++) drums[i].isPlaying.filter((note, index) => {\n        if (note) {\n          let drum = drums[i].midiID;\n          let noteObj = {\n            sample: drum,\n            beatIndex: index\n          };\n          notesToPlay.push(noteObj);\n          return notesToPlay;\n        }\n      });\n\n      let bpm = this.state.bpm;\n      let beat = 4 * 60 / bpm;\n      let duration = beat / 16;\n      let time = null;\n\n      if (this.midiSounds === null) {\n        time = 0;\n      } else {\n        time = this.midiSounds.contextTime();\n      }\n\n      console.log(this.midiSounds);\n      notesToPlay.map(note => {\n        let noteTime = time + (duration + duration * note.beatIndex);\n        this.midiSounds.playDrumsAt(noteTime, [note.sample]);\n      });\n    };\n\n    this.togglePlaying = (sampleIndex, beatIndex) => {\n      let updatedDrumObjs = [...this.state.drumObjs];\n      let updatedIsPlaying = updatedDrumObjs[sampleIndex].isPlaying;\n      updatedIsPlaying[beatIndex] = !updatedIsPlaying[beatIndex];\n      updatedDrumObjs[sampleIndex].isPlaying = [...this.state.drumObjs[sampleIndex].isPlaying];\n      this.setState({\n        drumObjs: updatedDrumObjs\n      });\n    };\n\n    this.handleSave = () => {\n      fetch(URL + '/beats', {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(this.state)\n      }).then(response => response.json()).then(response => {\n        console.log(\"Saved to db\", response);\n      });\n    };\n\n    this.renderMIDISounds = () => {\n      return /*#__PURE__*/React.createElement(MIDISounds, {\n        ref: ref => this.midiSounds = ref,\n        appElementName: \"root\",\n        instruments: [3, 458],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 7\n        }\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"drumblr\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(HeaderContainer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      playSequence: this.playSequence,\n      handleSave: this.handleSave,\n      bpm: this.state.bpm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(SampleContainer, {\n      app: this.state,\n      togglePlaying: this.togglePlaying,\n      sequenceThisNote: this.sequenceThisNote,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"FooterContainer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    })), this.renderMIDISounds());\n  }\n\n}","map":{"version":3,"sources":["/Users/ryan/Documents/GitHub/drumblr_frontend/src/App.js"],"names":["React","MIDISounds","SampleContainer","HeaderContainer","NavBar","URL","App","Component","state","bpm","name","drumObjs","midiID","isPlaying","playSequence","notesToPlay","drums","i","length","filter","note","index","drum","noteObj","sample","beatIndex","push","beat","duration","time","midiSounds","contextTime","console","log","map","noteTime","playDrumsAt","togglePlaying","sampleIndex","updatedDrumObjs","updatedIsPlaying","setState","handleSave","fetch","method","headers","body","JSON","stringify","then","response","json","renderMIDISounds","ref","render","sequenceThisNote"],"mappings":"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","sourcesContent":["import React from 'react';\nimport MIDISounds from 'midi-sounds-react';\nimport SampleContainer from './SampleContainer';\nimport HeaderContainer from './HeaderContainer';\nimport NavBar from './NavBar';\nimport './css/App.css';\nconst URL = 'http://localhost:3000';\n\nexport default class App extends React.Component {\n\n  state = {\n    // just chose a default bpm to set state with\n    bpm: 120,\n    // name for saved beats\n    name: 'test',\n    // I just hardcoded in some basic drums to start\n    drumObjs: [{\n        midiID: 3, \n        name: 'Bass Drum', \n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false],\n      }, {\n        midiID: 22, \n        name: 'Hand Clap', \n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false],\n      }, {\n        midiID: 26, \n        name: 'Snare', \n        isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false],\n      },{\n      midiID: 35, \n      name: 'Closed Hi-hat', \n      isPlaying: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false],\n    }],\n  }\n\n\n  playSequence = () => {\n\n    // gets array of notes with value of true\n    let notesToPlay = []\n    let drums = [...this.state.drumObjs]\n    for (let i=0; i<drums.length; i++)\n      drums[i].isPlaying.filter((note, index )=> {\n        if (note){\n          let drum = drums[i].midiID\n          let noteObj = {sample: drum, beatIndex: index}          \n          notesToPlay.push(noteObj)\n          return notesToPlay\n        }\n      })\n    \n    let bpm = this.state.bpm \n    let beat = 4 * 60 / bpm\n    let duration = beat/16\n    let time = null\n    if (this.midiSounds === null){\n      time = 0\n    } else{\n      time = this.midiSounds.contextTime()\n    }\n    console.log(this.midiSounds)\n    notesToPlay.map(note => {\n      let noteTime = time + (duration + (duration * note.beatIndex))\n      this.midiSounds.playDrumsAt(noteTime, [note.sample])\n      \n    })\n  }\n\n  togglePlaying = (sampleIndex, beatIndex) => {\n    let updatedDrumObjs = [...this.state.drumObjs]\n    let updatedIsPlaying = updatedDrumObjs[sampleIndex].isPlaying\n    updatedIsPlaying[beatIndex] = !updatedIsPlaying[beatIndex]\n    updatedDrumObjs[sampleIndex].isPlaying = [...this.state.drumObjs[sampleIndex].isPlaying]\n    this.setState({\n      drumObjs: updatedDrumObjs\n    })\n  }\n\n  // persist current sequence to database\n  handleSave = () => {\n    fetch(URL + '/beats', {\n      method: \"POST\",\n      headers: {\"Content-Type\": \"application/json\"},\n      body: JSON.stringify(this.state)\n    })\n    .then(response => response.json())\n    .then(response => {\n      console.log(\"Saved to db\", response);\n    })\n  }\n\n  // render MIDISounds logo in order for samples to play when sequence is triggered\n  renderMIDISounds = () => {\n    return (\n      <MIDISounds \n      ref={(ref) => (this.midiSounds = ref)}\n      appElementName=\"root\" \n      instruments={[3, 458]}\n      />\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <div className=\"drumblr\">\n          <HeaderContainer />\n          <NavBar playSequence={this.playSequence} handleSave={this.handleSave} bpm={this.state.bpm} />\n          <SampleContainer app={this.state} togglePlaying={this.togglePlaying} sequenceThisNote={this.sequenceThisNote}/>\n          <div className=\"FooterContainer\"></div>\n        </div>\n        {this.renderMIDISounds()}\n      </div>\n  );\n}\n}\n"]},"metadata":{},"sourceType":"module"}